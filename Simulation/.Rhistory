d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
library(lme4)
library(lme4qtl)
library(lmerTest)
n = 100
Trans = 2
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
library(lme4)
library(lme4qtl)
library(lmerTest)
n = 100
Trans = 2
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
library(lme4)
library(lme4qtl)
library(lmerTest)
n = 100
Trans = 2
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
library(lme4)
library(lme4qtl)
library(lmerTest)
n = 100
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
library(lme4)
library(lme4qtl)
library(lmerTest)
n = 100
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
library(lme4)
library(lme4qtl)
library(lmerTest)
n = 100
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
d$x = d$X2
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
relmatLmer(y~x+(1|ID),d,relmat = list(ID=S))
library(lme4)
library(lme4qtl)
library(lmerTest)
n = 10
Trans = 20
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X2
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
relmatLmer(y~x+(1|ID),d,relmat = list(ID=S))
relmatLmer(y~x+(1|ID),subset(d,Trans==1),relmat = list(ID=S))
relmatLmer(y~x+(1|ID),subset(d,Trans==2),relmat = list(ID=S))
relmatLmer(y~x+(1|ID),subset(d,Trans==3),relmat = list(ID=S))
anova(relmatLmer(y~x+(1|ID),subset(d,Trans==3),relmat = list(ID=S)))
anova(relmatLmer(y~x+(1|ID),subset(d,Trans==2),relmat = list(ID=S)))
anova(relmatLmer(y~x+(1|ID),subset(d,Trans==1),relmat = list(ID=S)))
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 10
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X2
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 10
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X2
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 10
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X2
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 10
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X2
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 10
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X2
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 10
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X2
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 10
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X2
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 100
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X2
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 100
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X2
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 100
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 10
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 10
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 10
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 10
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 10
Trans = 1
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 10
Trans = 10
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 10
Trans = 10
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
n = 10
Trans = 10
d = c()
for(t in 1:Trans) {
d = rbind(d,data.frame(Trans = t,X = seq(-1,1,length=n)))
}
d$ID = 1:nrow(d)
d$X2 = sample(d$X)
D = as.matrix(dist(d$X))
S = max(D) - D
rownames(S) = colnames(S) = d$ID
if(Trans>1) {
Tr = tcrossprod(model.matrix(~0+factor(Trans),d))
S = S *Tr
}
cS = chol(S)
d$x = d$X
d$y = d$x + t(cS) %*% rnorm(n*Trans) + .1*rnorm(n*Trans)
anova(relmatLmer(y~x+(1|ID),d,relmat = list(ID=S)))
anova(relmatLmer(y~x+(1|ID),subset(d,Trans==1),relmat = list(ID=S)))
anova(relmatLmer(y~x+(1|ID),subset(d,Trans==2),relmat = list(ID=S)))
